<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê·¸ë¦¬ìŠ¤ í‰í™” ìˆ˜í˜¸ ê²Œì„ - í‚¹ëª¬ìŠ¤í„° í™•ì¥íŒ</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      text-align: center;
      background: url('images/background.png') no-repeat center center fixed;
      background-size: cover;
      padding: 30px;
      margin: 0;
      overflow: hidden;
    }
    #game-area {
      position: relative;
      width: 800px;
      height: 600px;
      margin: 0 auto;
      background-color: rgba(255,255,255,0.2);
      border: 2px solid #333;
      overflow: hidden;
    }
    .monster, .sword, .potion, .king-monster {
      position: absolute;
    }
    .monster img, .sword img, #hero img, .potion img, .king-monster img {
      width: 100%;
      height: auto;
    }
    #hero {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      transition: transform 0.1s linear;
      width: 100px;
      height: 100px;
    }
    .swing {
      animation: swingAnimation 0.3s ease;
    }
    @keyframes swingAnimation {
      0% { transform: rotate(0deg); }
      50% { transform: rotate(30deg); }
      100% { transform: rotate(0deg); }
    }
    #status, #message {
      margin-top: 20px;
      font-size: 18px;
    }
    .instructions {
      background-color: rgba(255,255,255,0.7);
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

<h1>âš”ï¸ ê·¸ë¦¬ìŠ¤ í‰í™” ìˆ˜í˜¸ ê²Œì„ - í‚¹ëª¬ìŠ¤í„° í™•ì¥íŒ âš”ï¸</h1>

<div class="instructions">
  <p>ë°©í–¥í‚¤ë¡œ ì´ë™, ìŠ¤í˜ì´ìŠ¤ë°”ë¡œ ì¹¼ ë°œì‚¬! ë¬¼ì•½ì„ ëª¨ì•„ í‚¹ ëª¬ìŠ¤í„°ë¥¼ ë¬´ì°Œë¥´ì„¸ìš”!</p>
</div>

<div id="game-area">
  <div id="hero">
    <img id="heroImage" src="images/hero.png" alt="ì£¼ì¸ê³µ">
  </div>
</div>

<div id="status">
  <p>ì²˜ì¹˜: 0</p>
  <p>ë‚¨ì€ ì²´ë ¥: 3</p>
  <p>ë¬¼ì•½: 0</p>
</div>

<div id="message"></div>

<script>
const gameArea = document.getElementById('game-area');
const hero = document.getElementById('hero');
const heroImage = document.getElementById('heroImage');

let heroX = 400 - 50;
let heroY = 500;
let playerHealth = 3;
let playerKills = 0;
let potionCount = 0;
let monsters = [];
let swords = [];
let potions = [];
let kingMonster = null;
let kingMonsterSpawned = false;
let gameActive = true;
let spawnRate = 3000;
let lastSpawnTime = Date.now();

// ğŸ”¥ ì‚¬ìš´ë“œ
const swordSwingSound = new Audio('sounds/sword_swing.mp3');
swordSwingSound.volume = 0.5;
const bgm = new Audio('sounds/bgm_epic_adventure.mp3');
bgm.volume = 0.3;
bgm.loop = true;
bgm.play();

function updateHeroPosition() {
  hero.style.left = heroX + 'px';
  hero.style.top = heroY + 'px';
}

function createMonster() {
  const monsterDiv = document.createElement('div');
  monsterDiv.className = 'monster';
  const monsterImg = document.createElement('img');
  const monsterType = Math.random() < 0.5 ? 1 : 2;
  monsterImg.src = `images/monster${monsterType}.png`;
  monsterImg.alt = 'ëª¬ìŠ¤í„°';
  monsterDiv.appendChild(monsterImg);
  gameArea.appendChild(monsterDiv);

  const monsterSpeed = 1 + Math.random() * 2;
  const monsterY = Math.random() * 450;

  monsterDiv.style.left = '800px';
  monsterDiv.style.top = monsterY + 'px';

  monsters.push({
    element: monsterDiv,
    health: monsterType === 1 ? 1 : 2,
    speed: monsterSpeed,
    x: 800,
    y: monsterY,
    width: 100,
    height: 100
  });

  if (Math.random() < 0.2) { // 20% í™•ë¥ ë¡œ ë¬¼ì•½ ìƒì„±
    createPotion();
  }
}

function createPotion() {
  const potionDiv = document.createElement('div');
  potionDiv.className = 'potion';
  const potionImg = document.createElement('img');
  potionImg.src = 'images/potion.png';
  potionImg.alt = 'ë¬¼ì•½';
  potionDiv.appendChild(potionImg);
  gameArea.appendChild(potionDiv);

  const potionX = 800; // ì˜¤ë¥¸ìª½ ëì—ì„œ ì‹œì‘
  const potionY = Math.random() * 500;
  potionDiv.style.left = potionX + 'px';
  potionDiv.style.top = potionY + 'px';

  // ğŸ¯ í¬ê¸° ì¡°ì • (60px)
  potionDiv.style.width = '60px';
  potionDiv.style.height = '60px';

  potions.push({
    element: potionDiv,
    x: potionX,
    y: potionY,
    speed: 1, // ë¬¼ì•½ì´ ì™¼ìª½ìœ¼ë¡œ ì´ë™
    width: 60,
    height: 60
  });
}

function shootSword() {
  const sword = document.createElement('div');
  sword.className = 'sword';
  const swordImg = document.createElement('img');
  swordImg.src = 'images/sword.png';
  swordImg.alt = 'ì¹¼';
  sword.appendChild(swordImg);
  const swordX = heroX + 80; // ì£¼ì¸ê³µ ì•ìœ¼ë¡œ ë°œì‚¬
  const swordY = heroY + 30; // ì£¼ì¸ê³µ ì¤‘ì•™ ì •ë„ ë†’ì´ì—ì„œ ë°œì‚¬
  sword.style.left = swordX + 'px';
  sword.style.top = swordY + 'px';
  gameArea.appendChild(sword);
  swords.push({
    element: sword,
    x: swordX,
    y: swordY,
    speed: 15,
    width: 30,
    height: 10
  });

  swordSwingSound.currentTime = 0;
  swordSwingSound.play();

  heroImage.classList.add('swing');
  setTimeout(() => heroImage.classList.remove('swing'), 300);
}

function spawnKingMonster() {
  kingMonsterSpawned = true;
  const kingDiv = document.createElement('div');
  kingDiv.className = 'king-monster';
  const kingImg = document.createElement('img');
  kingImg.src = 'images/king_monster.png';
  kingImg.alt = 'í‚¹ ëª¬ìŠ¤í„°';
  kingDiv.appendChild(kingImg);
  gameArea.appendChild(kingDiv);

  kingDiv.style.left = '700px';
  kingDiv.style.top = '250px';

  kingMonster = {
    element: kingDiv,
    health: 5,
    x: 700,
    y: 250,
    width: 150,
    height: 150
  };
}

function checkCollision(obj1, obj2) {
  return (
    obj1.x < obj2.x + obj2.width &&
    obj1.x + obj1.width > obj2.x &&
    obj1.y < obj2.y + obj2.height &&
    obj1.y + obj1.height > obj2.y
  );
}

function updateGame() {
  if (!gameActive) return;

  // ëª¬ìŠ¤í„° ì´ë™
  for (let i = monsters.length - 1; i >= 0; i--) {
    const monster = monsters[i];
    const dx = heroX - monster.x;
    const dy = heroY - monster.y;
    const distance = Math.sqrt(dx * dx + dy * dy);

    if (distance > 50) {
      monster.x += (dx / distance) * monster.speed;
      monster.y += (dy / distance) * monster.speed;
      monster.element.style.left = monster.x + 'px';
      monster.element.style.top = monster.y + 'px';
    } else {
      playerHealth -= 1;
      updateStatus();
      gameArea.removeChild(monster.element);
      monsters.splice(i, 1);
      if (playerHealth <= 0) {
        gameOver();
      }
    }
  }

  // ë¬¼ì•½ ì´ë™
  for (let i = potions.length - 1; i >= 0; i--) {
    const potion = potions[i];
    potion.x -= potion.speed;
    potion.element.style.left = potion.x + 'px';

    // í¬ì…˜ ì¶©ëŒ ì²´í¬
    if (checkCollision({ x: heroX, y: heroY, width: 100, height: 100 }, potion)) {
      potionCount += 1;
      gameArea.removeChild(potion.element);
      potions.splice(i, 1);
      updateStatus();
    } else if (potion.x < -60) { // í™”ë©´ ì™¼ìª½ ë„˜ì–´ê°€ë©´ ì œê±°
      gameArea.removeChild(potion.element);
      potions.splice(i, 1);
    }
  }

  // ì¹¼ ì´ë™
  for (let i = swords.length - 1; i >= 0; i--) {
    const sword = swords[i];
    sword.x += sword.speed;
    sword.element.style.left = sword.x + 'px';

    if (sword.x > 800) {
      gameArea.removeChild(sword.element);
      swords.splice(i, 1);
      continue;
    }

    let hit = false;
    for (let j = monsters.length - 1; j >= 0; j--) {
      const monster = monsters[j];
      if (checkCollision(sword, monster)) {
        hit = true;
        monster.health -= 1;
        if (monster.health <= 0) {
          gameArea.removeChild(monster.element);
          monsters.splice(j, 1);
          playerKills += 1;
          updateStatus();
        }
        break;
      }
    }

    if (!hit && kingMonster && checkCollision(sword, kingMonster)) {
      hit = true;
      if (potionCount >= 5) {
        kingMonster.health -= 1;
        if (kingMonster.health <= 0) {
          gameArea.removeChild(kingMonster.element);
          kingMonster = null;
          gameClear();
        }
      }
    }

    if (hit) {
      gameArea.removeChild(sword.element);
      swords.splice(i, 1);
    }
  }

  if (playerKills >= 50 && !kingMonsterSpawned) {
    spawnKingMonster();
  }

  const currentTime = Date.now();
  if (currentTime - lastSpawnTime > spawnRate) {
    if (!kingMonsterSpawned) createMonster();
    lastSpawnTime = currentTime;
    spawnRate = Math.max(1000, spawnRate - 100);
  }
}

function updateStatus() {
  document.getElementById('status').innerHTML = `
    <p>ì²˜ì¹˜: ${playerKills}</p>
    <p>ë‚¨ì€ ì²´ë ¥: ${playerHealth}</p>
    <p>ë¬¼ì•½: ${potionCount}</p>
  `;
}

function gameOver() {
  gameActive = false;
  document.getElementById('message').innerText = 'ğŸ’€ ê²Œì„ ì˜¤ë²„! ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ë‹¤ì‹œ ì‹œì‘í•˜ì„¸ìš”.';
  clearInterval(gameInterval);
  bgm.pause();
}

function gameClear() {
  gameActive = false;
  document.getElementById('message').innerText = 'ğŸ‰ í‰í™”ë¥¼ ìˆ˜í˜¸í–ˆìŠµë‹ˆë‹¤! ì¶•í•˜í•©ë‹ˆë‹¤! ğŸ‰';
  clearInterval(gameInterval);
  bgm.pause();
}

window.addEventListener('keydown', (e) => {
  if (!gameActive) return;
  const moveSpeed = 10;
  if (e.key === 'ArrowLeft') heroX -= moveSpeed;
  if (e.key === 'ArrowRight') heroX += moveSpeed;
  if (e.key === 'ArrowUp') heroY -= moveSpeed;
  if (e.key === 'ArrowDown') heroY += moveSpeed;
  if (e.key === ' ') shootSword();
  heroX = Math.max(0, Math.min(700, heroX));
  heroY = Math.max(0, Math.min(500, heroY));
  updateHeroPosition();
});

// ê²Œì„ ì‹œì‘
updateHeroPosition();
createMonster();
const gameInterval = setInterval(updateGame, 30);
</script>

</body>
</html>
